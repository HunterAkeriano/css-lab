import{d as E,x as O,s as V,O as k,u as R,i as T,h as N,P as D,c as u,o as p,b,a as s,e as t,t as i,m as x,l as m,p as w,v as y,z as f,f as L,w as C,_ as H}from"./index-DAd-KxhA.js";import{S as P,l as G}from"./auth-BafdylY0.js";import{a as $}from"./auth-CoLzQyyB.js";const B={class:"login-page"},M={class:"login-page__content"},q={class:"login-page__form-container"},z={class:"login-page__header"},j={class:"login-page__title"},F={class:"login-page__subtitle"},W={class:"login-form__field"},J={class:"login-form__label",for:"email"},K={key:0,class:"login-form__error"},Q={class:"login-form__field"},X={class:"login-form__label",for:"password"},Y={key:0,class:"login-form__error"},Z=["disabled"],ee={key:0,class:"login-form__server-error"},se={class:"login-page__footer"},oe={class:"login-page__footer-text"},te=E({__name:"LoginPage",setup(ae){const S=O(),g=V(),v=k(),{t:o,locale:h}=R(),l=T({email:"",password:""}),a=T({}),c=N(!1),_=N("");function I(d){a[d]=void 0,_.value=""}async function U(){Object.keys(a).forEach(e=>{a[e]=void 0}),_.value="";const d=G.safeParse(l);if(!d.success){d.error.issues.forEach(e=>{const r=e.path[0];a[r]=e.message});return}c.value=!0;try{const e=await $.login(l);v.setToken(e.token),v.setUser(e.user);const r=typeof g.query.redirect=="string"?g.query.redirect:`/${h.value}/profile`;S.push(r)}catch(e){if(Array.isArray(e==null?void 0:e.issues)&&e.issues.length){e.issues.forEach(r=>{var A;const n=(A=r.path)==null?void 0:A[0];n&&(a[n]=r.message)});return}(e==null?void 0:e.message)==="Invalid credentials"?_.value=o("VALIDATION.INVALID_CREDENTIALS"):_.value=o("VALIDATION.SERVER_ERROR")}finally{c.value=!1}}return(d,e)=>{const r=D("RouterLink");return p(),u("div",B,[b(t(P)),s("div",M,[s("div",q,[s("div",z,[s("h1",j,i(t(o)("AUTH.LOGIN_TITLE")),1),s("p",F,i(t(o)("AUTH.LOGIN_SUBTITLE")),1)]),s("form",{class:"login-form",onSubmit:x(U,["prevent"]),novalidate:""},[s("div",W,[s("label",J,i(t(o)("AUTH.EMAIL")),1),w(s("input",{id:"email","onUpdate:modelValue":e[0]||(e[0]=n=>l.email=n),type:"email",class:f(["login-form__input",{"login-form__input_error":a.email}]),autocomplete:"email",onInput:e[1]||(e[1]=n=>I("email"))},null,34),[[y,l.email]]),a.email?(p(),u("span",K,i(t(o)(`VALIDATION.${a.email}`)),1)):m("",!0)]),s("div",Q,[s("label",X,i(t(o)("AUTH.PASSWORD")),1),w(s("input",{id:"password","onUpdate:modelValue":e[2]||(e[2]=n=>l.password=n),type:"password",class:f(["login-form__input",{"login-form__input_error":a.password}]),autocomplete:"current-password",onInput:e[3]||(e[3]=n=>I("password"))},null,34),[[y,l.password]]),a.password?(p(),u("span",Y,i(t(o)(`VALIDATION.${a.password}`)),1)):m("",!0)]),s("button",{type:"submit",class:f(["login-form__submit",{"login-form__submit_loading":c.value}]),disabled:c.value},i(c.value?t(o)("AUTH.SIGNING_IN"):t(o)("AUTH.LOGIN_BUTTON")),11,Z),_.value?(p(),u("div",ee,i(_.value),1)):m("",!0)],32),s("div",se,[s("p",oe,[L(i(t(o)("AUTH.NO_ACCOUNT"))+" ",1),b(r,{to:`/${t(h)}/register`,class:"login-page__link"},{default:C(()=>[L(i(t(o)("AUTH.SIGN_UP")),1)]),_:1},8,["to"])])])])])])}}}),le=H(te,[["__scopeId","data-v-ee21180a"]]);export{le as default};
